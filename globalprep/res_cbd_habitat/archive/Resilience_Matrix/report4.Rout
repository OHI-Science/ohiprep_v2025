
R version 2.15.3 (2013-03-01) -- "Security Blanket"
Copyright (C) 2013 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> require(ohi)
Loading required package: ohi
Loading required package: reshape2
Loading OHI options (version 0.9.10)
> options(digits=4)
> options(width=70)
> ## Example for computing HAB resilience
> 
> 
> # For habitats we have a notion of all the unique combination of habitat presence
> # across all countries. Then, the compute a resilience per region we take the straight
> # mean across the habitats present. This is a "shortcut" but unfortunately is makes
> # the code more obtuse.
> r.combo <- ohi.read.csv('/var/data/ohi/model/GL-NCEAS-Resilience_Matrix/data/global_resilience_combos.csv')[,1:2]
> r.component <- r.combo$component
> names(r.component) <- r.combo$id
> r.component
                                       1 
   "habitats-bd-soft-bottom-with-corals" 
                                       2 
"habitats-bd-soft-bottom-without-corals" 
                                       3 
   "habitats-bd-soft-bottom-with-corals" 
                                       4 
   "habitats-bd-soft-bottom-with-corals" 
                                       5 
   "habitats-bd-soft-bottom-with-corals" 
                                       6 
   "habitats-bd-soft-bottom-with-corals" 
                                       7 
   "habitats-bd-soft-bottom-with-corals" 
                                       8 
   "habitats-bd-soft-bottom-with-corals" 
                                       9 
   "habitats-bd-soft-bottom-with-corals" 
                                      10 
   "habitats-bd-soft-bottom-with-corals" 
                                      11 
   "habitats-bd-soft-bottom-with-corals" 
                                      12 
   "habitats-bd-soft-bottom-with-corals" 
                                      13 
   "habitats-bd-soft-bottom-with-corals" 
                                      14 
   "habitats-bd-soft-bottom-with-corals" 
                                      15 
   "habitats-bd-soft-bottom-with-corals" 
                                      16 
"habitats-bd-soft-bottom-without-corals" 
                                      17 
"habitats-bd-soft-bottom-without-corals" 
                                      18 
   "habitats-bd-soft-bottom-with-corals" 
                                      19 
   "habitats-bd-soft-bottom-with-corals" 
                                      20 
   "habitats-bd-soft-bottom-with-corals" 
                                      21 
   "habitats-bd-soft-bottom-with-corals" 
                                      22 
   "habitats-bd-soft-bottom-with-corals" 
                                      23 
   "habitats-bd-soft-bottom-with-corals" 
                                      24 
   "habitats-bd-soft-bottom-with-corals" 
                                      25 
   "habitats-bd-soft-bottom-with-corals" 
                                      26 
   "habitats-bd-soft-bottom-with-corals" 
                                      27 
   "habitats-bd-soft-bottom-with-corals" 
                                      28 
   "habitats-bd-soft-bottom-with-corals" 
                                      29 
   "habitats-bd-soft-bottom-with-corals" 
                                      30 
   "habitats-bd-soft-bottom-with-corals" 
                                      31 
   "habitats-bd-soft-bottom-with-corals" 
                                      32 
   "habitats-bd-soft-bottom-with-corals" 
                                      33 
   "habitats-bd-soft-bottom-with-corals" 
                                      34 
   "habitats-bd-soft-bottom-with-corals" 
                                      35 
   "habitats-bd-soft-bottom-with-corals" 
                                      36 
   "habitats-bd-soft-bottom-with-corals" 
                                      37 
   "habitats-bd-soft-bottom-with-corals" 
                                      38 
   "habitats-bd-soft-bottom-with-corals" 
                                      39 
"habitats-bd-soft-bottom-without-corals" 
                                      40 
   "habitats-bd-soft-bottom-with-corals" 
                                      41 
"habitats-bd-soft-bottom-without-corals" 
                                      42 
"habitats-bd-soft-bottom-without-corals" 
                                      43 
"habitats-bd-soft-bottom-without-corals" 
                                      44 
"habitats-bd-soft-bottom-without-corals" 
                                      45 
"habitats-bd-soft-bottom-without-corals" 
                                      46 
"habitats-bd-soft-bottom-without-corals" 
                                      47 
"habitats-bd-soft-bottom-without-corals" 
                                      48 
"habitats-bd-soft-bottom-without-corals" 
                                      49 
"habitats-bd-soft-bottom-without-corals" 
                                      50 
"habitats-bd-soft-bottom-without-corals" 
                                      51 
"habitats-bd-soft-bottom-without-corals" 
                                      52 
"habitats-bd-soft-bottom-without-corals" 
                                      53 
"habitats-bd-soft-bottom-without-corals" 
                                      54 
"habitats-bd-soft-bottom-without-corals" 
                                      55 
"habitats-bd-soft-bottom-without-corals" 
                                      56 
"habitats-bd-soft-bottom-without-corals" 
                                      57 
"habitats-bd-soft-bottom-without-corals" 
                                      58 
"habitats-bd-soft-bottom-without-corals" 
                                      59 
"habitats-bd-soft-bottom-without-corals" 
                                      60 
"habitats-bd-soft-bottom-without-corals" 
                                      61 
"habitats-bd-soft-bottom-without-corals" 
                                      62 
"habitats-bd-soft-bottom-without-corals" 
                                      63 
"habitats-bd-soft-bottom-without-corals" 
                                      64 
"habitats-bd-soft-bottom-without-corals" 
                                      65 
"habitats-bd-soft-bottom-without-corals" 
                                      66 
"habitats-bd-soft-bottom-without-corals" 
                                      67 
"habitats-bd-soft-bottom-without-corals" 
                                      68 
"habitats-bd-soft-bottom-without-corals" 
                                      69 
"habitats-bd-soft-bottom-without-corals" 
                                      70 
"habitats-bd-soft-bottom-without-corals" 
                                      71 
"habitats-bd-soft-bottom-without-corals" 
                                      72 
           "habitats-bd-seagrasses-only" 
                                      73 
"habitats-bd-soft-bottom-without-corals" 
                                      74 
"habitats-bd-soft-bottom-without-corals" 
                                      75 
   "habitats-bd-soft-bottom-with-corals" 
                                      76 
"habitats-bd-soft-bottom-without-corals" 
                                      77 
"habitats-bd-soft-bottom-without-corals" 
                                      78 
"habitats-bd-soft-bottom-without-corals" 
                                      79 
   "habitats-bd-soft-bottom-with-corals" 
                                      80 
   "habitats-bd-soft-bottom-with-corals" 
                                      81 
   "habitats-bd-soft-bottom-with-corals" 
                                      82 
   "habitats-bd-soft-bottom-with-corals" 
                                      83 
   "habitats-bd-soft-bottom-with-corals" 
                                      84 
   "habitats-bd-soft-bottom-with-corals" 
                                      85 
   "habitats-bd-soft-bottom-with-corals" 
                                      86 
   "habitats-bd-soft-bottom-with-corals" 
                                      87 
   "habitats-bd-soft-bottom-with-corals" 
                                      88 
   "habitats-bd-soft-bottom-with-corals" 
                                      89 
   "habitats-bd-soft-bottom-with-corals" 
                                      90 
   "habitats-bd-soft-bottom-with-corals" 
                                      91 
   "habitats-bd-soft-bottom-with-corals" 
                                      92 
   "habitats-bd-soft-bottom-with-corals" 
                                      93 
   "habitats-bd-soft-bottom-with-corals" 
                                      94 
   "habitats-bd-soft-bottom-with-corals" 
                                      95 
   "habitats-bd-soft-bottom-with-corals" 
                                      96 
   "habitats-bd-soft-bottom-with-corals" 
                                      97 
   "habitats-bd-soft-bottom-with-corals" 
                                      98 
   "habitats-bd-soft-bottom-with-corals" 
                                      99 
   "habitats-bd-soft-bottom-with-corals" 
                                     100 
"habitats-bd-soft-bottom-without-corals" 
                                     101 
   "habitats-bd-soft-bottom-with-corals" 
                                     102 
"habitats-bd-soft-bottom-without-corals" 
                                     103 
   "habitats-bd-soft-bottom-with-corals" 
                                     104 
"habitats-bd-soft-bottom-without-corals" 
                                     105 
   "habitats-bd-soft-bottom-with-corals" 
                                     106 
   "habitats-bd-soft-bottom-with-corals" 
                                     107 
"habitats-bd-soft-bottom-without-corals" 
                                     108 
               "habitats-bd-corals-only" 
                                     109 
   "habitats-bd-soft-bottom-with-corals" 
                                     110 
   "habitats-bd-soft-bottom-with-corals" 
                                     111 
   "habitats-bd-soft-bottom-with-corals" 
                                     112 
   "habitats-bd-soft-bottom-with-corals" 
                                     113 
   "habitats-bd-soft-bottom-with-corals" 
                                     114 
   "habitats-bd-soft-bottom-with-corals" 
                                     115 
   "habitats-bd-soft-bottom-with-corals" 
                                     116 
   "habitats-bd-soft-bottom-with-corals" 
                                     117 
   "habitats-bd-soft-bottom-with-corals" 
                                     118 
   "habitats-bd-soft-bottom-with-corals" 
                                     119 
"habitats-bd-soft-bottom-without-corals" 
                                     120 
"habitats-bd-soft-bottom-without-corals" 
                                     121 
"habitats-bd-soft-bottom-without-corals" 
                                     122 
   "habitats-bd-soft-bottom-with-corals" 
                                     123 
"habitats-bd-soft-bottom-without-corals" 
                                     124 
"habitats-bd-soft-bottom-without-corals" 
                                     125 
"habitats-bd-soft-bottom-without-corals" 
                                     126 
"habitats-bd-soft-bottom-without-corals" 
                                     127 
"habitats-bd-soft-bottom-without-corals" 
                                     128 
"habitats-bd-soft-bottom-without-corals" 
                                     129 
"habitats-bd-soft-bottom-without-corals" 
                                     130 
"habitats-bd-soft-bottom-without-corals" 
                                     131 
"habitats-bd-soft-bottom-without-corals" 
                                     132 
"habitats-bd-soft-bottom-without-corals" 
                                     133 
"habitats-bd-soft-bottom-without-corals" 
                                     134 
"habitats-bd-soft-bottom-without-corals" 
                                     135 
"habitats-bd-soft-bottom-without-corals" 
                                     137 
"habitats-bd-soft-bottom-without-corals" 
                                     138 
"habitats-bd-soft-bottom-without-corals" 
                                     139 
"habitats-bd-soft-bottom-without-corals" 
                                     140 
"habitats-bd-soft-bottom-without-corals" 
                                     141 
   "habitats-bd-soft-bottom-with-corals" 
                                     142 
   "habitats-bd-soft-bottom-with-corals" 
                                     143 
"habitats-bd-soft-bottom-without-corals" 
                                     144 
"habitats-bd-soft-bottom-without-corals" 
                                     145 
"habitats-bd-soft-bottom-without-corals" 
                                     146 
"habitats-bd-soft-bottom-without-corals" 
                                     147 
"habitats-bd-soft-bottom-without-corals" 
                                     148 
"habitats-bd-soft-bottom-without-corals" 
                                     149 
"habitats-bd-soft-bottom-without-corals" 
                                     150 
"habitats-bd-soft-bottom-without-corals" 
                                     151 
"habitats-bd-soft-bottom-without-corals" 
                                     152 
   "habitats-bd-soft-bottom-with-corals" 
                                     153 
   "habitats-bd-soft-bottom-with-corals" 
                                     154 
   "habitats-bd-soft-bottom-with-corals" 
                                     155 
   "habitats-bd-soft-bottom-with-corals" 
                                     156 
   "habitats-bd-soft-bottom-with-corals" 
                                     157 
   "habitats-bd-soft-bottom-with-corals" 
                                     158 
   "habitats-bd-soft-bottom-with-corals" 
                                     159 
   "habitats-bd-soft-bottom-with-corals" 
                                     160 
   "habitats-bd-soft-bottom-with-corals" 
                                     161 
   "habitats-bd-soft-bottom-with-corals" 
                                     162 
"habitats-bd-soft-bottom-without-corals" 
                                     163 
   "habitats-bd-soft-bottom-with-corals" 
                                     164 
   "habitats-bd-soft-bottom-with-corals" 
                                     165 
   "habitats-bd-soft-bottom-with-corals" 
                                     166 
"habitats-bd-soft-bottom-without-corals" 
                                     167 
"habitats-bd-soft-bottom-without-corals" 
                                     168 
"habitats-bd-soft-bottom-without-corals" 
                                     169 
"habitats-bd-soft-bottom-without-corals" 
                                     170 
"habitats-bd-soft-bottom-without-corals" 
                                     171 
   "habitats-bd-soft-bottom-with-corals" 
                                     172 
"habitats-bd-soft-bottom-without-corals" 
> 
> # extract relavant resilience layers for HAB goal
> ohi.load('global_resilience_matrix')
> names(global_resilience_matrix) <- tolower(names(global_resilience_matrix))
> layers <- subset(global_resilience_matrix, goal == 'biodiversity' & component %in% r.component)[,-1]
> layers
                                component             layer
13                habitats-bd-corals-only             water
14                habitats-bd-corals-only    fishing-v3-eez
15                habitats-bd-corals-only habitat-combo-eez
16                habitats-bd-corals-only           tourism
17                habitats-bd-corals-only       mariculture
18                habitats-bd-corals-only     alien-species
19                habitats-bd-corals-only species-diversity
20                habitats-bd-corals-only           wgi-all
21            habitats-bd-seagrasses-only             water
22            habitats-bd-seagrasses-only habitat-combo-eez
23            habitats-bd-seagrasses-only           tourism
24            habitats-bd-seagrasses-only       mariculture
25            habitats-bd-seagrasses-only     alien-species
26            habitats-bd-seagrasses-only species-diversity
27            habitats-bd-seagrasses-only           wgi-all
28    habitats-bd-soft-bottom-with-corals             water
29    habitats-bd-soft-bottom-with-corals    fishing-v2-eez
30    habitats-bd-soft-bottom-with-corals habitat-combo-eez
31    habitats-bd-soft-bottom-with-corals           tourism
32    habitats-bd-soft-bottom-with-corals       mariculture
33    habitats-bd-soft-bottom-with-corals     alien-species
34    habitats-bd-soft-bottom-with-corals species-diversity
35    habitats-bd-soft-bottom-with-corals           wgi-all
36 habitats-bd-soft-bottom-without-corals             water
37 habitats-bd-soft-bottom-without-corals    fishing-v1-eez
38 habitats-bd-soft-bottom-without-corals habitat-combo-eez
39 habitats-bd-soft-bottom-without-corals           tourism
40 habitats-bd-soft-bottom-without-corals       mariculture
41 habitats-bd-soft-bottom-without-corals     alien-species
42 habitats-bd-soft-bottom-without-corals species-diversity
43 habitats-bd-soft-bottom-without-corals           wgi-all
> 
> # extract resilience layers typing information
> # XXX: we need to fix the global_resilience_layers to use the correct values
> ohi.load('global_resilience_layers')
> names(global_resilience_layers) <- tolower(names(global_resilience_layers))
> d <- subset(global_resilience_layers, layer %in% layers$layer)[,c('layer', 'type', 'category', 'value')]
> d$type <- ifelse(d$type == 'ecological', 'environmental', d$type)
> d$type <- ifelse(paste(d$type, d$category) == 'environmental regulations', 'regulatory', d$type)
> t <- d$type
> names(t) <- d$layer
> t
    alien-species    fishing-v1-eez    fishing-v2-eez 
     "regulatory"      "regulatory"      "regulatory" 
   fishing-v3-eez habitat-combo-eez       mariculture 
     "regulatory"      "regulatory"      "regulatory" 
species-diversity           tourism             water 
  "environmental"      "regulatory"      "regulatory" 
          wgi-all 
         "social" 
> 
> # extract resilience layers weighting information for the per resilience category aggregations
> w <- d$value
> names(w) <- d$layer
> w
    alien-species    fishing-v1-eez    fishing-v2-eez 
                1                 2                 2 
   fishing-v3-eez habitat-combo-eez       mariculture 
                2                 2                 1 
species-diversity           tourism             water 
                1                 1                 1 
          wgi-all 
                1 
> 
> # extract resilience layers data for regions
> ohi.load('global_v_resilience_layers')
> r <- acast(id ~ layer, data=subset(global_v_resilience_layers, id %in% 1:172 & layer %in% layers$layer))
> names(dimnames(r)) <- c('region_id', 'layer')
> r
         layer
region_id alien-species fishing-v1-eez fishing-v2-eez fishing-v3-eez
      1         0.62500      5.616e-01      5.977e-01      5.687e-01
      2         0.62500      5.591e-01      5.958e-01      5.687e-01
      3         0.52547      3.485e-01      4.008e-01      3.602e-01
      4         0.75000      3.504e-01      3.653e-01      3.640e-01
      5         1.00000      4.264e-01      4.223e-01      4.549e-01
      6         0.50000      4.003e-01      4.027e-01      4.398e-01
      7         0.50000      3.100e-01      3.350e-01      3.033e-01
      8         0.50000      3.185e-01      3.414e-01      3.033e-01
      9         0.50000      3.126e-01      3.554e-01      3.280e-01
      10        0.74382      4.855e-01      5.036e-01      5.008e-01
      11        0.50000      4.649e-01      4.881e-01      4.896e-01
      12        0.62500      5.623e-01      5.982e-01      5.688e-01
      13        0.50000      3.300e-01      3.685e-01      3.280e-01
      14        0.50000      2.829e-01      3.147e-01      3.034e-01
      15        0.50000      2.461e-01      2.871e-01      3.034e-01
      16        0.75000      4.913e-01      5.450e-01      5.081e-01
      17        0.62500      4.074e-01      4.081e-01      3.942e-01
      18        0.50000      4.914e-01      5.265e-01      5.137e-01
      19        0.50000      4.794e-01      5.176e-01      4.844e-01
      20        0.50000      4.380e-01      4.310e-01      4.397e-01
      21        0.51981      4.179e-01      4.159e-01      4.110e-01
      22        0.87500      4.388e-01      4.316e-01      4.548e-01
      23        0.50000      4.247e-01      4.211e-01      4.397e-01
      24        0.70431      4.593e-01      4.470e-01      4.292e-01
      25        0.50000      3.108e-01      3.356e-01      3.034e-01
      26        0.50000      4.741e-01      4.581e-01      4.700e-01
      27        0.50000      4.276e-01      4.232e-01      4.397e-01
      28        0.50000      4.260e-01      4.220e-01      4.397e-01
      29        0.62500      5.112e-01      5.229e-01      5.193e-01
      30        0.50000      2.843e-01      3.157e-01      3.033e-01
      31        0.50000      4.298e-01      4.619e-01      4.284e-01
      32        0.50000      3.466e-01      3.837e-01      4.242e-01
      33        0.50000      3.240e-01      3.825e-01      3.527e-01
      34        0.50000      2.875e-01      3.181e-01      3.033e-01
      35        0.50000      3.269e-01      3.662e-01      3.280e-01
      36        0.75000      4.476e-01      4.382e-01      4.548e-01
      37        0.50000      3.607e-01      4.285e-01      3.773e-01
      38        0.50000      3.798e-01      4.078e-01      3.306e-01
      39        0.50000      4.074e-01      4.451e-01      4.284e-01
      40        0.50000      4.094e-01      4.280e-01      4.038e-01
      41        0.50000      4.407e-01      4.330e-01      4.245e-01
      42        0.50000      4.714e-01      4.931e-01      5.042e-01
      43        0.63576      4.599e-01      4.830e-01      4.362e-01
      44        0.62500      4.538e-01      4.983e-01      4.682e-01
      45        1.00000      5.091e-01      5.213e-01      5.195e-01
      46        0.02781      1.857e-01      2.418e-01      1.897e-01
      47        0.50000      5.030e-01      4.983e-01      4.947e-01
      48        0.50000      5.011e-01      5.153e-01      5.042e-01
      49        0.50000      4.558e-01      4.629e-01      4.508e-01
      50        0.50000      2.572e-01      2.954e-01      3.033e-01
      51        0.50000      4.076e-01      4.452e-01      4.284e-01
      52        0.62500      4.648e-01      4.881e-01      4.739e-01
      53        0.50000      4.373e-01      4.860e-01      4.682e-01
      54        0.50000      3.350e-01      3.907e-01      3.527e-01
      55        0.50000      4.399e-01      4.694e-01      4.436e-01
      56        0.50000      4.303e-01      4.807e-01      4.532e-01
      57        0.50000      3.950e-01      4.543e-01      3.773e-01
      58        0.62500      4.533e-01      4.795e-01      4.470e-01
      59        0.50000      5.137e-01      5.433e-01      5.313e-01
      60        0.50000      4.978e-01      5.313e-01      5.039e-01
      61        0.50000      5.082e-01      5.206e-01      5.193e-01
      62        0.87500      4.674e-01      5.086e-01      4.688e-01
      63        0.62500      4.785e-01      4.984e-01      4.890e-01
      64        0.75000      5.050e-01      5.368e-01      5.289e-01
      65        0.50000      4.423e-01      4.897e-01      4.531e-01
      66        0.50000      4.405e-01      4.884e-01      4.533e-01
      67        0.66521      5.123e-01      5.607e-01      5.374e-01
      68        0.66521      5.409e-01      5.822e-01      5.374e-01
      69        0.50000      4.896e-01      5.067e-01      4.739e-01
      70        1.00000      3.619e-01      3.739e-01      3.657e-01
      71        0.50000      3.394e-01      3.570e-01      3.488e-01
      72        0.50000      3.989e-01      4.017e-01      3.791e-01
      73        0.50000      4.038e-01      4.219e-01      4.163e-01
      74        0.62500      4.943e-01      5.657e-01      5.176e-01
      75        0.62500      5.262e-01      5.526e-01      5.289e-01
      76        0.50000      2.947e-01      3.235e-01      3.033e-01
      77        0.50000      3.462e-01      3.622e-01      3.033e-01
      78        0.50000      4.116e-01      4.112e-01      4.245e-01
      79        0.50000      4.605e-01      5.340e-01      4.641e-01
      80        0.75000      4.626e-01      5.049e-01      4.701e-01
      81        0.50000      5.529e-01      5.912e-01      5.540e-01
      82        0.50000      3.190e-01      3.602e-01      3.280e-01
      83        0.87500      3.935e-01      4.346e-01      4.172e-01
      84        0.09710      2.755e-01      3.650e-01      3.121e-01
      85        0.59710      4.531e-01      4.885e-01      4.635e-01
      86        0.50000      3.730e-01      4.378e-01      3.793e-01
      87        0.50000      4.573e-01      4.825e-01      4.739e-01
      88        0.50000      5.107e-01      5.410e-01      5.137e-01
      89        0.50000      4.603e-01      5.032e-01      4.684e-01
      90        0.75000      4.620e-01      4.675e-01      4.947e-01
      91        0.50000      4.237e-01      4.388e-01      4.644e-01
      92        0.50000      4.183e-01      4.532e-01      4.436e-01
      93        0.62500      4.320e-01      4.450e-01      4.804e-01
      94        0.59710      4.891e-01      4.905e-01      4.312e-01
      95        0.75000      4.717e-01      4.748e-01      4.948e-01
      96        0.75000      4.368e-01      4.486e-01      4.823e-01
      97        0.50000      3.521e-01      3.851e-01      3.886e-01
      98        0.50000      4.173e-01      4.432e-01      4.464e-01
      99        0.62500      4.733e-01      4.760e-01      4.958e-01
      100       1.00000      4.620e-01      5.045e-01      4.836e-01
      101       0.87500      4.379e-01      4.495e-01      4.795e-01
      102       0.50000      4.004e-01      4.213e-01      4.492e-01
      103       0.62500      4.590e-01      4.832e-01      4.884e-01
      104       0.62500      4.297e-01      4.803e-01      4.531e-01
      105       0.50000      2.892e-01      3.749e-01      3.773e-01
      106       0.59710      4.858e-01      5.229e-01      4.863e-01
      107       0.50000      3.563e-01      4.067e-01      3.527e-01
      108       0.50000      5.322e-01      5.545e-01      5.206e-01
      109       0.50000      5.054e-01      5.185e-01      4.995e-01
      110       0.00000      3.158e-01      4.504e-01      3.307e-01
      111       0.00000      3.048e-01      4.201e-01      3.014e-01
      112       0.50000      5.670e-01      5.878e-01      5.501e-01
      113       0.50000      3.787e-01      4.420e-01      3.773e-01
      114       0.00000      3.195e-01      4.531e-01      3.327e-01
      115       0.62506      5.430e-01      5.837e-01      5.686e-01
      116       0.12500      3.356e-01      4.097e-01      3.421e-01
      117       0.62500      5.417e-01      5.642e-01      5.440e-01
      118       0.50000      3.016e-01      3.472e-01      3.287e-01
      119       0.50000      4.069e-01      4.262e-01      4.189e-01
      120       0.50000      3.299e-01      3.869e-01      3.527e-01
      121       0.71045      4.358e-01      4.478e-01      4.461e-01
      122       0.75000      4.544e-01      4.733e-01      4.799e-01
      123       0.75000      4.848e-01      5.216e-01      5.033e-01
      124       0.62500      4.442e-01      4.912e-01      4.683e-01
      125       0.87500      4.839e-01      5.024e-01      4.956e-01
      126       0.75000      4.493e-01      5.131e-01      4.774e-01
      127       0.62500      5.251e-01      5.333e-01      5.276e-01
      128       0.62500      4.407e-01      4.700e-01      4.599e-01
      129       0.75000      4.618e-01      5.043e-01      4.870e-01
      130       0.75000      5.086e-01      5.394e-01      5.299e-01
      131       0.62500      5.381e-01      5.616e-01      5.573e-01
      132       0.50000      4.886e-01      5.059e-01      5.042e-01
      133       0.75000      4.077e-01      4.450e-01      4.297e-01
      134       0.62500      4.355e-01      4.660e-01      4.737e-01
      135       0.50000      3.989e-01      4.387e-01      4.331e-01
      136       0.50000      3.519e-01      4.139e-01      3.666e-01
      137       0.13576      3.189e-01      3.773e-01      2.689e-01
      138       0.62500      3.974e-01      4.006e-01      4.137e-01
      139       0.50000      4.842e-01      5.012e-01      4.935e-01
      140       1.00000      4.905e-01      5.259e-01      5.364e-01
      141       0.75000      4.560e-01      5.000e-01      5.015e-01
      142       0.75000      4.357e-01      4.848e-01      4.535e-01
      143       0.50000      3.377e-01      3.762e-01      3.306e-01
      144       0.50000      4.914e-01      4.895e-01      4.795e-01
      145       0.50000      3.816e-01      3.887e-01      3.791e-01
      146       0.50000      4.507e-01      4.405e-01      4.548e-01
      147       0.50000      3.063e-01      3.507e-01      3.280e-01
      148       0.62500      4.039e-01      4.054e-01      4.245e-01
      149       0.50000      3.566e-01      4.070e-01      3.527e-01
      150       0.50000      4.001e-01      4.211e-01      4.038e-01
      151       0.62500      3.841e-01      4.056e-01      3.839e-01
      152       0.50000      4.772e-01      5.159e-01      4.834e-01
      153       0.75000      4.822e-01      4.642e-01      4.730e-01
      154       0.50000      4.638e-01      4.874e-01      4.587e-01
      155       0.50000      3.793e-01      3.870e-01      4.094e-01
      156       1.00000      4.946e-01      5.105e-01      5.066e-01
      157       0.50000      4.712e-01      4.720e-01      4.460e-01
      158       0.50000      3.775e-01      4.017e-01      3.983e-01
      159       0.75000      5.513e-01      5.900e-01      5.541e-01
      160       0.62500      3.834e-01      3.901e-01      3.943e-01
      161       0.48838      3.730e-01      4.050e-01      3.299e-01
      162       0.00000      2.935e-05      2.201e-05      2.935e-05
      163       0.50000      5.288e-01      5.546e-01      5.485e-01
      164       0.50000      7.783e-01      7.067e-01      8.003e-01
      165       0.62500      4.402e-01      4.326e-01      4.711e-01
      166       0.62500      4.825e-01      5.199e-01      4.988e-01
      167       0.62500      4.773e-01      4.975e-01      4.739e-01
      168       0.50000      4.216e-01      4.372e-01      4.657e-01
      169       0.75000      5.322e-01      5.541e-01      5.420e-01
      170       1.00000      5.655e-01      5.822e-01      5.440e-01
      171       0.50000      3.039e-01      3.465e-01      3.247e-01
      172       0.50000      3.319e-01      3.870e-01      3.507e-01
         layer
region_id habitat-combo-eez mariculture species-diversity tourism
      1           5.000e-01     0.98460            0.8416 0.83705
      2           5.000e-01     0.98460            0.8432 0.83705
      3           2.612e-01     0.52756            0.8702 0.51086
      4           3.410e-01     0.87500            0.8837 0.58333
      5           4.773e-01     1.00000            0.8726 0.72222
      6           4.546e-01     0.87500            0.8648 0.72222
      7           2.500e-01     0.50000            0.8583 0.50000
      8           2.500e-01     0.50000            0.8415 0.50000
      9           2.500e-01     0.50000            0.8775 0.50000
      10          4.722e-01     0.95226            0.8779 0.68655
      11          4.555e-01     0.62500            0.8766 0.72222
      12          5.003e-01     1.00000            0.8621 0.83333
      13          2.500e-01     0.50000            0.8784 0.50000
      14          2.500e-01     0.50000            0.8690 0.50000
      15          2.501e-01     0.50000            0.8665 0.50000
      16          4.091e-01     0.75000            0.8370 0.69444
      17          3.864e-01     0.62500            0.8476 0.63889
      18          4.545e-01     0.58333            0.9138 0.66667
      19          4.106e-01     0.91667            0.9029 0.88889
      20          4.545e-01     0.54167            0.8600 0.77778
      21          4.115e-01     0.63825            0.8545 0.70024
      22          4.773e-01     0.83333            0.8569 0.86111
      23          4.546e-01     0.83333            0.8507 0.86111
      24          4.389e-01     0.84040            0.8449 0.71707
      25          2.501e-01     0.50000            0.8591 0.50000
      26          5.000e-01     1.00000            0.8663 0.69444
      27          4.545e-01     0.66667            0.8635 0.58333
      28          4.545e-01     0.83333            0.8536 0.80556
      29          5.000e-01     0.79167            0.8676 0.83333
      30          2.500e-01     0.50000            0.8724 0.50000
      31          3.636e-01     0.58333            0.9197 0.75000
      32          3.887e-01     0.50000            0.9176 0.75000
      33          2.500e-01     0.50000            0.8788 0.50000
      34          2.500e-01     0.50000            0.8672 0.50000
      35          2.500e-01     0.50000            0.9149 0.50000
      36          4.773e-01     0.50000            0.9268 1.00000
      37          2.500e-01     0.50000            0.9340 0.50000
      38          2.500e-01     0.50000            0.9353 0.50000
      39          3.636e-01     0.62500            0.8580 0.72222
      40          3.636e-01     0.50000            0.9308 0.63889
      41          4.318e-01     0.54167            0.8143 0.75000
      42          4.773e-01     0.70833            0.8658 0.75000
      43          3.782e-01     0.84193            0.8324 0.70390
      44          3.864e-01     0.75000            0.8622 0.88889
      45          5.003e-01     1.00000            0.8086 0.80556
      46          7.955e-02     0.05443            0.8084 0.19144
      47          5.000e-01     0.54167            0.8354 0.72222
      48          4.773e-01     0.95833            0.8208 0.75000
      49          4.342e-01     0.54167            0.8212 0.94444
      50          2.500e-01     0.50000            0.8694 0.50000
      51          3.636e-01     0.70833            0.8503 0.72222
      52          4.318e-01     0.87500            0.8938 0.55556
      53          3.864e-01     0.79167            0.9146 0.63889
      54          2.500e-01     0.50000            0.8270 0.50000
      55          3.864e-01     0.58333            0.8640 0.83333
      56          3.638e-01     0.62500            0.9101 0.72222
      57          2.500e-01     0.50000            0.8536 0.50000
      58          3.915e-01     0.58333            0.8596 0.55556
      59          4.809e-01     0.70833            0.8567 0.83333
      60          4.399e-01     0.58333            0.9436 0.58333
      61          5.000e-01     0.66667            0.9369 0.83333
      62          3.872e-01     0.91667            0.9242 0.77778
      63          4.546e-01     0.95833            0.8954 0.83333
      64          4.773e-01     0.79167            0.9286 0.94444
      65          3.636e-01     0.75000            0.8755 0.50000
      66          3.640e-01     0.58333            0.8512 0.88889
      67          4.531e-01     0.84314            0.8030 0.73975
      68          4.531e-01     0.84314            0.8269 0.73975
      69          4.318e-01     0.54167            0.8365 0.66667
      70          3.435e-01     0.54167            0.8373 0.55556
      71          3.182e-01     0.50000            0.8365 0.50000
      72          3.636e-01     0.58333            0.8381 0.61111
      73          3.864e-01     0.50000            0.8422 0.50000
      74          3.864e-01     0.62500            0.8325 0.77778
      75          4.773e-01     0.83333            0.8231 0.72222
      76          2.500e-01     0.50000            0.8544 0.50000
      77          2.500e-01     0.50000            0.8293 0.50000
      78          4.318e-01     0.50000            0.8380 0.77778
      79          3.190e-01     0.62658            0.8394 0.57501
      80          3.891e-01     0.79167            0.8706 0.72222
      81          4.780e-01     0.70833            0.8739 0.88889
      82          2.500e-01     0.50000            0.8733 0.50000
      83          3.468e-01     0.83333            0.8615 0.83333
      84          1.515e-01     0.19717            0.8647 0.28626
      85          3.979e-01     0.69717            0.8328 0.78626
      86          2.530e-01     0.50000            0.8897 0.50000
      87          4.318e-01     0.54167            0.8578 0.63889
      88          4.545e-01     0.83333            0.8816 0.75000
      89          3.866e-01     0.66667            0.8579 0.63889
      90          5.000e-01     0.70833            0.8401 0.61111
      91          4.545e-01     0.54167            0.8738 0.66667
      92          3.864e-01     0.50000            0.8663 0.50000
      93          4.785e-01     0.54167            0.8738 0.88889
      94          3.995e-01     0.69717            0.8629 0.78626
      95          5.002e-01     0.91667            0.8627 0.88889
      96          4.815e-01     0.83333            0.8461 0.83333
      97          3.409e-01     0.50000            0.8766 0.50000
      98          4.091e-01     0.70833            0.8494 0.83333
      99          5.017e-01     0.70833            0.8701 0.88889
      100         4.094e-01     0.75000            0.8539 0.61111
      101         4.773e-01     0.75000            0.8477 0.88889
      102         4.318e-01     0.58333            0.8441 0.88889
      103         4.547e-01     0.62500            0.8429 0.88889
      104         3.636e-01     0.70833            0.8449 0.83333
      105         2.500e-01     0.50000            0.8551 0.50000
      106         4.122e-01     0.69717            0.8543 0.78626
      107         2.500e-01     0.50000            0.8024 0.50000
      108         4.703e-01     0.79369            0.8623 0.84264
      109         4.703e-01     0.79369            0.8815 0.84264
      110         6.904e-02     0.12658            0.8470 0.07501
      111         6.905e-02     0.12658            0.8651 0.07501
      112         5.001e-01     0.83333            0.8869 0.88889
      113         2.500e-01     0.50000            0.8880 0.50000
      114         7.209e-02     0.12658            0.8669 0.07501
      115         4.999e-01     0.54166            0.8446 0.94405
      116         1.971e-01     0.50000            0.8474 0.44444
      117         5.000e-01     0.75000            0.8809 0.83333
      118         2.511e-01     0.50000            0.8555 0.50000
      119         3.864e-01     0.50000            0.8353 0.55556
      120         2.500e-01     0.50000            0.8321 0.50000
      121         4.271e-01     0.64179            0.8342 0.77777
      122         4.548e-01     0.62500            0.8454 0.83333
      123         4.389e-01     0.62500            0.8303 0.63889
      124         3.864e-01     0.54167            0.8033 0.83333
      125         4.644e-01     0.83333            0.9559 0.77778
      126         3.637e-01     0.91667            0.8715 0.77778
      127         5.124e-01     0.75000            0.8541 0.83333
      128         4.109e-01     1.00000            0.8527 0.88889
      129         4.145e-01     0.70833            0.8694 0.77778
      130         4.788e-01     1.00000            0.8344 0.77778
      131         5.199e-01     0.79167            0.8374 0.77778
      132         4.773e-01     0.95833            0.8196 0.75000
      133         3.660e-01     0.91667            0.8174 0.72222
      134         4.318e-01     1.00000            0.7961 0.88889
      135         3.706e-01     0.70833            0.8553 0.72222
      136         2.500e-01     0.50000            0.8906 0.50000
      137         1.273e-01     0.34193            0.8635 0.00000
      138         4.155e-01     0.70833            0.8709 0.50000
      139         4.641e-01     0.79167            0.8777 0.61111
      140         4.886e-01     0.70833            0.8690 0.55556
      141         4.363e-01     0.50000            0.9371 0.80556
      142         3.643e-01     0.75000            0.9139 0.55556
      143         2.500e-01     0.50000            0.9357 0.50000
      144         4.773e-01     0.50000            0.8207 0.66667
      145         3.636e-01     0.54167            0.8201 0.66667
      146         4.773e-01     0.95833            0.8391 0.50000
      147         2.500e-01     0.50000            0.8341 0.50000
      148         4.318e-01     0.50000            0.8385 0.88889
      149         2.500e-01     0.50000            0.8202 0.50000
      150         3.636e-01     0.50000            0.8851 0.50000
      151         3.409e-01     0.75000            0.8144 0.61111
      152         4.091e-01     0.50000            0.8648 0.77778
      153         5.044e-01     0.95833            0.8662 0.80556
      154         4.091e-01     0.54167            0.8978 0.63889
      155         4.091e-01     0.50000            0.8793 0.50000
      156         4.810e-01     0.91667            0.8883 0.77778
      157         4.318e-01     0.79167            0.8815 0.63889
      158         3.604e-01     0.75000            0.8913 0.72222
      159         4.782e-01     0.95833            0.8622 0.69444
      160         3.864e-01     0.95833            0.8655 0.50000
      161         2.443e-01     0.48838            0.8544 0.48838
      162         4.402e-05     0.00000            0.8724 0.00000
      163         5.068e-01     0.50000            0.9251 0.94444
      164         9.545e-01     0.62500            0.9287 0.75000
      165         5.016e-01     0.79167            0.8794 0.83333
      166         4.322e-01     1.00000            0.9090 0.94444
      167         4.318e-01     1.00000            0.8030 0.94444
      168         4.566e-01     0.95833            0.9016 0.77778
      169         5.030e-01     0.83333            0.8464 0.77778
      170         5.000e-01     0.95833            0.8287 0.88889
      171         2.500e-01     0.50000            0.8933 0.50000
      172         2.500e-01     0.54167            0.8719 0.50000
         layer
region_id   water wgi-all
      1   1.00000 0.81661
      2   1.00000 0.81661
      3   0.52130 0.36428
      4   0.50000 0.55573
      5   1.00000 0.40791
      6   0.75000 0.55649
      7   0.50000 0.52875
      8   0.50000 0.53344
      9   0.50000 0.48115
      10  0.97837 0.66993
      11  1.00000 0.40331
      12  1.00000 0.81556
      13  0.50000 0.35905
      14  0.50000 0.35528
      15  0.50000 0.55510
      16  1.00000 0.64624
      17  0.75000 0.18656
      18  1.00000 0.33841
      19  1.00000 0.45484
      20  0.75000 0.28260
      21  0.90269 0.68493
      22  1.00000 0.52216
      23  1.00000 0.65518
      24  0.92895 0.36922
      25  0.50000 0.43858
      26  1.00000 0.40951
      27  1.00000 0.45855
      28  1.00000 0.38746
      29  1.00000 0.34573
      30  0.50000 0.04923
      31  0.75000 0.22621
      32  0.50000 0.39831
      33  0.50000 0.25078
      34  0.50000 0.57350
      35  0.50000 0.19201
      36  1.00000 0.44189
      37  0.50000 0.54308
      38  0.50000 0.54309
      39  1.00000 0.26826
      40  1.00000 0.60274
      41  0.50000 0.59578
      42  1.00000 0.75771
      43  0.97814 0.63530
      44  0.75000 0.49021
      45  1.00000 0.44245
      46  0.16524 0.30626
      47  0.75000 0.32524
      48  1.00000 0.40893
      49  1.00000 0.43462
      50  0.50000 0.32549
      51  1.00000 0.73800
      52  1.00000 0.63295
      53  1.00000 0.71491
      54  0.50000 0.55385
      55  0.75000 0.54418
      56  1.00000 0.35630
      57  0.50000 0.47518
      58  1.00000 0.39064
      59  1.00000 0.49591
      60  0.75000 0.31934
      61  1.00000 0.36613
      62  1.00000 0.59790
      63  1.00000 0.59938
      64  1.00000 0.70675
      65  1.00000 0.47507
      66  0.75000 0.33356
      67  0.97062 0.78473
      68  0.97062 0.78473
      69  0.75000 0.34813
      70  1.00000 0.32177
      71  1.00000 0.31942
      72  1.00000 0.45247
      73  0.50000 0.28781
      74  1.00000 0.56266
      75  0.50000 0.55555
      76  0.50000 0.42737
      77  0.50000 0.24457
      78  1.00000 0.52665
      79  0.58439 0.57029
      80  0.75000 0.69510
      81  1.00000 0.36233
      82  0.50000 0.29365
      83  0.75000 0.44173
      84  0.32793 0.63585
      85  0.82793 0.71983
      86  0.50000 0.68254
      87  1.00000 0.65736
      88  1.00000 0.68631
      89  1.00000 0.64697
      90  1.00000 0.71741
      91  1.00000 0.57893
      92  0.50000 0.54074
      93  0.75000 0.67924
      94  0.82793 0.65601
      95  0.75000 0.53492
      96  1.00000 0.62815
      97  0.75000 0.36575
      98  1.00000 0.42223
      99  1.00000 0.38505
      100 1.00000 0.48319
      101 0.75000 0.47092
      102 1.00000 0.38201
      103 1.00000 0.31923
      104 0.50000 0.43847
      105 0.50000 0.24601
      106 0.82793 0.64647
      107 0.50000 0.80070
      108 0.72027 0.55793
      109 0.72027 0.55793
      110 0.08439 0.57029
      111 0.08439 0.63746
      112 0.75000 0.57180
      113 0.50000 0.44836
      114 0.08439 0.57029
      115 0.99990 0.84678
      116 0.00000 0.73269
      117 0.50000 0.48394
      118 0.50000 0.49017
      119 1.00000 0.42107
      120 0.50000 0.48243
      121 0.83547 0.69701
      122 1.00000 0.52675
      123 0.50000 0.42549
      124 0.50000 0.66615
      125 1.00000 0.86351
      126 1.00000 0.76604
      127 1.00000 0.78445
      128 1.00000 0.82508
      129 1.00000 0.65587
      130 1.00000 0.74260
      131 1.00000 0.76238
      132 1.00000 0.79038
      133 1.00000 0.67520
      134 1.00000 0.71212
      135 1.00000 0.61433
      136 0.50000 0.76140
      137 0.47814 0.63530
      138 1.00000 0.58678
      139 1.00000 0.70263
      140 1.00000 0.64003
      141 1.00000 0.65267
      142 0.75000 0.25948
      143 0.50000 0.19975
      144 0.75000 0.29996
      145 1.00000 0.21253
      146 1.00000 0.25436
      147 0.50000 0.26561
      148 1.00000 0.33597
      149 0.50000 0.37827
      150 0.75000 0.16559
      151 0.75000 0.30542
      152 1.00000 0.44283
      153 1.00000 0.45713
      154 1.00000 0.32088
      155 0.50000 0.12264
      156 1.00000 0.54756
      157 1.00000 0.39681
      158 1.00000 0.78821
      159 1.00000 0.39830
      160 0.50000 0.73249
      161 0.48838 0.50912
      162 0.00000      NA
      163 1.00000 0.41250
      164 1.00000 0.50690
      165 1.00000 0.41816
      166 0.50000 0.82319
      167 0.50000 0.77889
      168 1.00000 0.84864
      169 1.00000 0.82296
      170 1.00000 0.73080
      171 0.50000 0.33597
      172 0.50000 0.43275
> 
> # extract data mask
> b <- ifelse(!is.na(r),T,F)
> b
         layer
region_id alien-species fishing-v1-eez fishing-v2-eez fishing-v3-eez
      1            TRUE           TRUE           TRUE           TRUE
      2            TRUE           TRUE           TRUE           TRUE
      3            TRUE           TRUE           TRUE           TRUE
      4            TRUE           TRUE           TRUE           TRUE
      5            TRUE           TRUE           TRUE           TRUE
      6            TRUE           TRUE           TRUE           TRUE
      7            TRUE           TRUE           TRUE           TRUE
      8            TRUE           TRUE           TRUE           TRUE
      9            TRUE           TRUE           TRUE           TRUE
      10           TRUE           TRUE           TRUE           TRUE
      11           TRUE           TRUE           TRUE           TRUE
      12           TRUE           TRUE           TRUE           TRUE
      13           TRUE           TRUE           TRUE           TRUE
      14           TRUE           TRUE           TRUE           TRUE
      15           TRUE           TRUE           TRUE           TRUE
      16           TRUE           TRUE           TRUE           TRUE
      17           TRUE           TRUE           TRUE           TRUE
      18           TRUE           TRUE           TRUE           TRUE
      19           TRUE           TRUE           TRUE           TRUE
      20           TRUE           TRUE           TRUE           TRUE
      21           TRUE           TRUE           TRUE           TRUE
      22           TRUE           TRUE           TRUE           TRUE
      23           TRUE           TRUE           TRUE           TRUE
      24           TRUE           TRUE           TRUE           TRUE
      25           TRUE           TRUE           TRUE           TRUE
      26           TRUE           TRUE           TRUE           TRUE
      27           TRUE           TRUE           TRUE           TRUE
      28           TRUE           TRUE           TRUE           TRUE
      29           TRUE           TRUE           TRUE           TRUE
      30           TRUE           TRUE           TRUE           TRUE
      31           TRUE           TRUE           TRUE           TRUE
      32           TRUE           TRUE           TRUE           TRUE
      33           TRUE           TRUE           TRUE           TRUE
      34           TRUE           TRUE           TRUE           TRUE
      35           TRUE           TRUE           TRUE           TRUE
      36           TRUE           TRUE           TRUE           TRUE
      37           TRUE           TRUE           TRUE           TRUE
      38           TRUE           TRUE           TRUE           TRUE
      39           TRUE           TRUE           TRUE           TRUE
      40           TRUE           TRUE           TRUE           TRUE
      41           TRUE           TRUE           TRUE           TRUE
      42           TRUE           TRUE           TRUE           TRUE
      43           TRUE           TRUE           TRUE           TRUE
      44           TRUE           TRUE           TRUE           TRUE
      45           TRUE           TRUE           TRUE           TRUE
      46           TRUE           TRUE           TRUE           TRUE
      47           TRUE           TRUE           TRUE           TRUE
      48           TRUE           TRUE           TRUE           TRUE
      49           TRUE           TRUE           TRUE           TRUE
      50           TRUE           TRUE           TRUE           TRUE
      51           TRUE           TRUE           TRUE           TRUE
      52           TRUE           TRUE           TRUE           TRUE
      53           TRUE           TRUE           TRUE           TRUE
      54           TRUE           TRUE           TRUE           TRUE
      55           TRUE           TRUE           TRUE           TRUE
      56           TRUE           TRUE           TRUE           TRUE
      57           TRUE           TRUE           TRUE           TRUE
      58           TRUE           TRUE           TRUE           TRUE
      59           TRUE           TRUE           TRUE           TRUE
      60           TRUE           TRUE           TRUE           TRUE
      61           TRUE           TRUE           TRUE           TRUE
      62           TRUE           TRUE           TRUE           TRUE
      63           TRUE           TRUE           TRUE           TRUE
      64           TRUE           TRUE           TRUE           TRUE
      65           TRUE           TRUE           TRUE           TRUE
      66           TRUE           TRUE           TRUE           TRUE
      67           TRUE           TRUE           TRUE           TRUE
      68           TRUE           TRUE           TRUE           TRUE
      69           TRUE           TRUE           TRUE           TRUE
      70           TRUE           TRUE           TRUE           TRUE
      71           TRUE           TRUE           TRUE           TRUE
      72           TRUE           TRUE           TRUE           TRUE
      73           TRUE           TRUE           TRUE           TRUE
      74           TRUE           TRUE           TRUE           TRUE
      75           TRUE           TRUE           TRUE           TRUE
      76           TRUE           TRUE           TRUE           TRUE
      77           TRUE           TRUE           TRUE           TRUE
      78           TRUE           TRUE           TRUE           TRUE
      79           TRUE           TRUE           TRUE           TRUE
      80           TRUE           TRUE           TRUE           TRUE
      81           TRUE           TRUE           TRUE           TRUE
      82           TRUE           TRUE           TRUE           TRUE
      83           TRUE           TRUE           TRUE           TRUE
      84           TRUE           TRUE           TRUE           TRUE
      85           TRUE           TRUE           TRUE           TRUE
      86           TRUE           TRUE           TRUE           TRUE
      87           TRUE           TRUE           TRUE           TRUE
      88           TRUE           TRUE           TRUE           TRUE
      89           TRUE           TRUE           TRUE           TRUE
      90           TRUE           TRUE           TRUE           TRUE
      91           TRUE           TRUE           TRUE           TRUE
      92           TRUE           TRUE           TRUE           TRUE
      93           TRUE           TRUE           TRUE           TRUE
      94           TRUE           TRUE           TRUE           TRUE
      95           TRUE           TRUE           TRUE           TRUE
      96           TRUE           TRUE           TRUE           TRUE
      97           TRUE           TRUE           TRUE           TRUE
      98           TRUE           TRUE           TRUE           TRUE
      99           TRUE           TRUE           TRUE           TRUE
      100          TRUE           TRUE           TRUE           TRUE
      101          TRUE           TRUE           TRUE           TRUE
      102          TRUE           TRUE           TRUE           TRUE
      103          TRUE           TRUE           TRUE           TRUE
      104          TRUE           TRUE           TRUE           TRUE
      105          TRUE           TRUE           TRUE           TRUE
      106          TRUE           TRUE           TRUE           TRUE
      107          TRUE           TRUE           TRUE           TRUE
      108          TRUE           TRUE           TRUE           TRUE
      109          TRUE           TRUE           TRUE           TRUE
      110          TRUE           TRUE           TRUE           TRUE
      111          TRUE           TRUE           TRUE           TRUE
      112          TRUE           TRUE           TRUE           TRUE
      113          TRUE           TRUE           TRUE           TRUE
      114          TRUE           TRUE           TRUE           TRUE
      115          TRUE           TRUE           TRUE           TRUE
      116          TRUE           TRUE           TRUE           TRUE
      117          TRUE           TRUE           TRUE           TRUE
      118          TRUE           TRUE           TRUE           TRUE
      119          TRUE           TRUE           TRUE           TRUE
      120          TRUE           TRUE           TRUE           TRUE
      121          TRUE           TRUE           TRUE           TRUE
      122          TRUE           TRUE           TRUE           TRUE
      123          TRUE           TRUE           TRUE           TRUE
      124          TRUE           TRUE           TRUE           TRUE
      125          TRUE           TRUE           TRUE           TRUE
      126          TRUE           TRUE           TRUE           TRUE
      127          TRUE           TRUE           TRUE           TRUE
      128          TRUE           TRUE           TRUE           TRUE
      129          TRUE           TRUE           TRUE           TRUE
      130          TRUE           TRUE           TRUE           TRUE
      131          TRUE           TRUE           TRUE           TRUE
      132          TRUE           TRUE           TRUE           TRUE
      133          TRUE           TRUE           TRUE           TRUE
      134          TRUE           TRUE           TRUE           TRUE
      135          TRUE           TRUE           TRUE           TRUE
      136          TRUE           TRUE           TRUE           TRUE
      137          TRUE           TRUE           TRUE           TRUE
      138          TRUE           TRUE           TRUE           TRUE
      139          TRUE           TRUE           TRUE           TRUE
      140          TRUE           TRUE           TRUE           TRUE
      141          TRUE           TRUE           TRUE           TRUE
      142          TRUE           TRUE           TRUE           TRUE
      143          TRUE           TRUE           TRUE           TRUE
      144          TRUE           TRUE           TRUE           TRUE
      145          TRUE           TRUE           TRUE           TRUE
      146          TRUE           TRUE           TRUE           TRUE
      147          TRUE           TRUE           TRUE           TRUE
      148          TRUE           TRUE           TRUE           TRUE
      149          TRUE           TRUE           TRUE           TRUE
      150          TRUE           TRUE           TRUE           TRUE
      151          TRUE           TRUE           TRUE           TRUE
      152          TRUE           TRUE           TRUE           TRUE
      153          TRUE           TRUE           TRUE           TRUE
      154          TRUE           TRUE           TRUE           TRUE
      155          TRUE           TRUE           TRUE           TRUE
      156          TRUE           TRUE           TRUE           TRUE
      157          TRUE           TRUE           TRUE           TRUE
      158          TRUE           TRUE           TRUE           TRUE
      159          TRUE           TRUE           TRUE           TRUE
      160          TRUE           TRUE           TRUE           TRUE
      161          TRUE           TRUE           TRUE           TRUE
      162          TRUE           TRUE           TRUE           TRUE
      163          TRUE           TRUE           TRUE           TRUE
      164          TRUE           TRUE           TRUE           TRUE
      165          TRUE           TRUE           TRUE           TRUE
      166          TRUE           TRUE           TRUE           TRUE
      167          TRUE           TRUE           TRUE           TRUE
      168          TRUE           TRUE           TRUE           TRUE
      169          TRUE           TRUE           TRUE           TRUE
      170          TRUE           TRUE           TRUE           TRUE
      171          TRUE           TRUE           TRUE           TRUE
      172          TRUE           TRUE           TRUE           TRUE
         layer
region_id habitat-combo-eez mariculture species-diversity tourism
      1                TRUE        TRUE              TRUE    TRUE
      2                TRUE        TRUE              TRUE    TRUE
      3                TRUE        TRUE              TRUE    TRUE
      4                TRUE        TRUE              TRUE    TRUE
      5                TRUE        TRUE              TRUE    TRUE
      6                TRUE        TRUE              TRUE    TRUE
      7                TRUE        TRUE              TRUE    TRUE
      8                TRUE        TRUE              TRUE    TRUE
      9                TRUE        TRUE              TRUE    TRUE
      10               TRUE        TRUE              TRUE    TRUE
      11               TRUE        TRUE              TRUE    TRUE
      12               TRUE        TRUE              TRUE    TRUE
      13               TRUE        TRUE              TRUE    TRUE
      14               TRUE        TRUE              TRUE    TRUE
      15               TRUE        TRUE              TRUE    TRUE
      16               TRUE        TRUE              TRUE    TRUE
      17               TRUE        TRUE              TRUE    TRUE
      18               TRUE        TRUE              TRUE    TRUE
      19               TRUE        TRUE              TRUE    TRUE
      20               TRUE        TRUE              TRUE    TRUE
      21               TRUE        TRUE              TRUE    TRUE
      22               TRUE        TRUE              TRUE    TRUE
      23               TRUE        TRUE              TRUE    TRUE
      24               TRUE        TRUE              TRUE    TRUE
      25               TRUE        TRUE              TRUE    TRUE
      26               TRUE        TRUE              TRUE    TRUE
      27               TRUE        TRUE              TRUE    TRUE
      28               TRUE        TRUE              TRUE    TRUE
      29               TRUE        TRUE              TRUE    TRUE
      30               TRUE        TRUE              TRUE    TRUE
      31               TRUE        TRUE              TRUE    TRUE
      32               TRUE        TRUE              TRUE    TRUE
      33               TRUE        TRUE              TRUE    TRUE
      34               TRUE        TRUE              TRUE    TRUE
      35               TRUE        TRUE              TRUE    TRUE
      36               TRUE        TRUE              TRUE    TRUE
      37               TRUE        TRUE              TRUE    TRUE
      38               TRUE        TRUE              TRUE    TRUE
      39               TRUE        TRUE              TRUE    TRUE
      40               TRUE        TRUE              TRUE    TRUE
      41               TRUE        TRUE              TRUE    TRUE
      42               TRUE        TRUE              TRUE    TRUE
      43               TRUE        TRUE              TRUE    TRUE
      44               TRUE        TRUE              TRUE    TRUE
      45               TRUE        TRUE              TRUE    TRUE
      46               TRUE        TRUE              TRUE    TRUE
      47               TRUE        TRUE              TRUE    TRUE
      48               TRUE        TRUE              TRUE    TRUE
      49               TRUE        TRUE              TRUE    TRUE
      50               TRUE        TRUE              TRUE    TRUE
      51               TRUE        TRUE              TRUE    TRUE
      52               TRUE        TRUE              TRUE    TRUE
      53               TRUE        TRUE              TRUE    TRUE
      54               TRUE        TRUE              TRUE    TRUE
      55               TRUE        TRUE              TRUE    TRUE
      56               TRUE        TRUE              TRUE    TRUE
      57               TRUE        TRUE              TRUE    TRUE
      58               TRUE        TRUE              TRUE    TRUE
      59               TRUE        TRUE              TRUE    TRUE
      60               TRUE        TRUE              TRUE    TRUE
      61               TRUE        TRUE              TRUE    TRUE
      62               TRUE        TRUE              TRUE    TRUE
      63               TRUE        TRUE              TRUE    TRUE
      64               TRUE        TRUE              TRUE    TRUE
      65               TRUE        TRUE              TRUE    TRUE
      66               TRUE        TRUE              TRUE    TRUE
      67               TRUE        TRUE              TRUE    TRUE
      68               TRUE        TRUE              TRUE    TRUE
      69               TRUE        TRUE              TRUE    TRUE
      70               TRUE        TRUE              TRUE    TRUE
      71               TRUE        TRUE              TRUE    TRUE
      72               TRUE        TRUE              TRUE    TRUE
      73               TRUE        TRUE              TRUE    TRUE
      74               TRUE        TRUE              TRUE    TRUE
      75               TRUE        TRUE              TRUE    TRUE
      76               TRUE        TRUE              TRUE    TRUE
      77               TRUE        TRUE              TRUE    TRUE
      78               TRUE        TRUE              TRUE    TRUE
      79               TRUE        TRUE              TRUE    TRUE
      80               TRUE        TRUE              TRUE    TRUE
      81               TRUE        TRUE              TRUE    TRUE
      82               TRUE        TRUE              TRUE    TRUE
      83               TRUE        TRUE              TRUE    TRUE
      84               TRUE        TRUE              TRUE    TRUE
      85               TRUE        TRUE              TRUE    TRUE
      86               TRUE        TRUE              TRUE    TRUE
      87               TRUE        TRUE              TRUE    TRUE
      88               TRUE        TRUE              TRUE    TRUE
      89               TRUE        TRUE              TRUE    TRUE
      90               TRUE        TRUE              TRUE    TRUE
      91               TRUE        TRUE              TRUE    TRUE
      92               TRUE        TRUE              TRUE    TRUE
      93               TRUE        TRUE              TRUE    TRUE
      94               TRUE        TRUE              TRUE    TRUE
      95               TRUE        TRUE              TRUE    TRUE
      96               TRUE        TRUE              TRUE    TRUE
      97               TRUE        TRUE              TRUE    TRUE
      98               TRUE        TRUE              TRUE    TRUE
      99               TRUE        TRUE              TRUE    TRUE
      100              TRUE        TRUE              TRUE    TRUE
      101              TRUE        TRUE              TRUE    TRUE
      102              TRUE        TRUE              TRUE    TRUE
      103              TRUE        TRUE              TRUE    TRUE
      104              TRUE        TRUE              TRUE    TRUE
      105              TRUE        TRUE              TRUE    TRUE
      106              TRUE        TRUE              TRUE    TRUE
      107              TRUE        TRUE              TRUE    TRUE
      108              TRUE        TRUE              TRUE    TRUE
      109              TRUE        TRUE              TRUE    TRUE
      110              TRUE        TRUE              TRUE    TRUE
      111              TRUE        TRUE              TRUE    TRUE
      112              TRUE        TRUE              TRUE    TRUE
      113              TRUE        TRUE              TRUE    TRUE
      114              TRUE        TRUE              TRUE    TRUE
      115              TRUE        TRUE              TRUE    TRUE
      116              TRUE        TRUE              TRUE    TRUE
      117              TRUE        TRUE              TRUE    TRUE
      118              TRUE        TRUE              TRUE    TRUE
      119              TRUE        TRUE              TRUE    TRUE
      120              TRUE        TRUE              TRUE    TRUE
      121              TRUE        TRUE              TRUE    TRUE
      122              TRUE        TRUE              TRUE    TRUE
      123              TRUE        TRUE              TRUE    TRUE
      124              TRUE        TRUE              TRUE    TRUE
      125              TRUE        TRUE              TRUE    TRUE
      126              TRUE        TRUE              TRUE    TRUE
      127              TRUE        TRUE              TRUE    TRUE
      128              TRUE        TRUE              TRUE    TRUE
      129              TRUE        TRUE              TRUE    TRUE
      130              TRUE        TRUE              TRUE    TRUE
      131              TRUE        TRUE              TRUE    TRUE
      132              TRUE        TRUE              TRUE    TRUE
      133              TRUE        TRUE              TRUE    TRUE
      134              TRUE        TRUE              TRUE    TRUE
      135              TRUE        TRUE              TRUE    TRUE
      136              TRUE        TRUE              TRUE    TRUE
      137              TRUE        TRUE              TRUE    TRUE
      138              TRUE        TRUE              TRUE    TRUE
      139              TRUE        TRUE              TRUE    TRUE
      140              TRUE        TRUE              TRUE    TRUE
      141              TRUE        TRUE              TRUE    TRUE
      142              TRUE        TRUE              TRUE    TRUE
      143              TRUE        TRUE              TRUE    TRUE
      144              TRUE        TRUE              TRUE    TRUE
      145              TRUE        TRUE              TRUE    TRUE
      146              TRUE        TRUE              TRUE    TRUE
      147              TRUE        TRUE              TRUE    TRUE
      148              TRUE        TRUE              TRUE    TRUE
      149              TRUE        TRUE              TRUE    TRUE
      150              TRUE        TRUE              TRUE    TRUE
      151              TRUE        TRUE              TRUE    TRUE
      152              TRUE        TRUE              TRUE    TRUE
      153              TRUE        TRUE              TRUE    TRUE
      154              TRUE        TRUE              TRUE    TRUE
      155              TRUE        TRUE              TRUE    TRUE
      156              TRUE        TRUE              TRUE    TRUE
      157              TRUE        TRUE              TRUE    TRUE
      158              TRUE        TRUE              TRUE    TRUE
      159              TRUE        TRUE              TRUE    TRUE
      160              TRUE        TRUE              TRUE    TRUE
      161              TRUE        TRUE              TRUE    TRUE
      162              TRUE        TRUE              TRUE    TRUE
      163              TRUE        TRUE              TRUE    TRUE
      164              TRUE        TRUE              TRUE    TRUE
      165              TRUE        TRUE              TRUE    TRUE
      166              TRUE        TRUE              TRUE    TRUE
      167              TRUE        TRUE              TRUE    TRUE
      168              TRUE        TRUE              TRUE    TRUE
      169              TRUE        TRUE              TRUE    TRUE
      170              TRUE        TRUE              TRUE    TRUE
      171              TRUE        TRUE              TRUE    TRUE
      172              TRUE        TRUE              TRUE    TRUE
         layer
region_id water wgi-all
      1    TRUE    TRUE
      2    TRUE    TRUE
      3    TRUE    TRUE
      4    TRUE    TRUE
      5    TRUE    TRUE
      6    TRUE    TRUE
      7    TRUE    TRUE
      8    TRUE    TRUE
      9    TRUE    TRUE
      10   TRUE    TRUE
      11   TRUE    TRUE
      12   TRUE    TRUE
      13   TRUE    TRUE
      14   TRUE    TRUE
      15   TRUE    TRUE
      16   TRUE    TRUE
      17   TRUE    TRUE
      18   TRUE    TRUE
      19   TRUE    TRUE
      20   TRUE    TRUE
      21   TRUE    TRUE
      22   TRUE    TRUE
      23   TRUE    TRUE
      24   TRUE    TRUE
      25   TRUE    TRUE
      26   TRUE    TRUE
      27   TRUE    TRUE
      28   TRUE    TRUE
      29   TRUE    TRUE
      30   TRUE    TRUE
      31   TRUE    TRUE
      32   TRUE    TRUE
      33   TRUE    TRUE
      34   TRUE    TRUE
      35   TRUE    TRUE
      36   TRUE    TRUE
      37   TRUE    TRUE
      38   TRUE    TRUE
      39   TRUE    TRUE
      40   TRUE    TRUE
      41   TRUE    TRUE
      42   TRUE    TRUE
      43   TRUE    TRUE
      44   TRUE    TRUE
      45   TRUE    TRUE
      46   TRUE    TRUE
      47   TRUE    TRUE
      48   TRUE    TRUE
      49   TRUE    TRUE
      50   TRUE    TRUE
      51   TRUE    TRUE
      52   TRUE    TRUE
      53   TRUE    TRUE
      54   TRUE    TRUE
      55   TRUE    TRUE
      56   TRUE    TRUE
      57   TRUE    TRUE
      58   TRUE    TRUE
      59   TRUE    TRUE
      60   TRUE    TRUE
      61   TRUE    TRUE
      62   TRUE    TRUE
      63   TRUE    TRUE
      64   TRUE    TRUE
      65   TRUE    TRUE
      66   TRUE    TRUE
      67   TRUE    TRUE
      68   TRUE    TRUE
      69   TRUE    TRUE
      70   TRUE    TRUE
      71   TRUE    TRUE
      72   TRUE    TRUE
      73   TRUE    TRUE
      74   TRUE    TRUE
      75   TRUE    TRUE
      76   TRUE    TRUE
      77   TRUE    TRUE
      78   TRUE    TRUE
      79   TRUE    TRUE
      80   TRUE    TRUE
      81   TRUE    TRUE
      82   TRUE    TRUE
      83   TRUE    TRUE
      84   TRUE    TRUE
      85   TRUE    TRUE
      86   TRUE    TRUE
      87   TRUE    TRUE
      88   TRUE    TRUE
      89   TRUE    TRUE
      90   TRUE    TRUE
      91   TRUE    TRUE
      92   TRUE    TRUE
      93   TRUE    TRUE
      94   TRUE    TRUE
      95   TRUE    TRUE
      96   TRUE    TRUE
      97   TRUE    TRUE
      98   TRUE    TRUE
      99   TRUE    TRUE
      100  TRUE    TRUE
      101  TRUE    TRUE
      102  TRUE    TRUE
      103  TRUE    TRUE
      104  TRUE    TRUE
      105  TRUE    TRUE
      106  TRUE    TRUE
      107  TRUE    TRUE
      108  TRUE    TRUE
      109  TRUE    TRUE
      110  TRUE    TRUE
      111  TRUE    TRUE
      112  TRUE    TRUE
      113  TRUE    TRUE
      114  TRUE    TRUE
      115  TRUE    TRUE
      116  TRUE    TRUE
      117  TRUE    TRUE
      118  TRUE    TRUE
      119  TRUE    TRUE
      120  TRUE    TRUE
      121  TRUE    TRUE
      122  TRUE    TRUE
      123  TRUE    TRUE
      124  TRUE    TRUE
      125  TRUE    TRUE
      126  TRUE    TRUE
      127  TRUE    TRUE
      128  TRUE    TRUE
      129  TRUE    TRUE
      130  TRUE    TRUE
      131  TRUE    TRUE
      132  TRUE    TRUE
      133  TRUE    TRUE
      134  TRUE    TRUE
      135  TRUE    TRUE
      136  TRUE    TRUE
      137  TRUE    TRUE
      138  TRUE    TRUE
      139  TRUE    TRUE
      140  TRUE    TRUE
      141  TRUE    TRUE
      142  TRUE    TRUE
      143  TRUE    TRUE
      144  TRUE    TRUE
      145  TRUE    TRUE
      146  TRUE    TRUE
      147  TRUE    TRUE
      148  TRUE    TRUE
      149  TRUE    TRUE
      150  TRUE    TRUE
      151  TRUE    TRUE
      152  TRUE    TRUE
      153  TRUE    TRUE
      154  TRUE    TRUE
      155  TRUE    TRUE
      156  TRUE    TRUE
      157  TRUE    TRUE
      158  TRUE    TRUE
      159  TRUE    TRUE
      160  TRUE    TRUE
      161  TRUE    TRUE
      162  TRUE   FALSE
      163  TRUE    TRUE
      164  TRUE    TRUE
      165  TRUE    TRUE
      166  TRUE    TRUE
      167  TRUE    TRUE
      168  TRUE    TRUE
      169  TRUE    TRUE
      170  TRUE    TRUE
      171  TRUE    TRUE
      172  TRUE    TRUE
> 
> # run resilience model, one region at a time
> # load which layers for each region based on the regions habitat combination
> x <- as.double(rep(NA, dim(r)[[1]]))
> names(x) <- dimnames(r)$region_id
> for (i in dimnames(r)$region_id) {
+   if (i %in% names(r.component)) {
+     habitat.combo.i <- r.component[[i]]
+     layers.i <- sort(subset(layers, component == habitat.combo.i)$layer)
+     b.i <- matrix(T, nrow=1, ncol=length(layers.i), dimnames=list(region_id=i, layer=layers.i))
+     w.i <- w[layers.i]
+     w.i <- ohi.model.resilience.matrix(b.i, w.i)
+     x[[i]] <- ohi.model.resilience(r[i,layers.i, drop=F], t, w.i)
+   }
+ }
> x
     1      2      3      4      5      6      7      8      9     10 
0.7950 0.7930 0.5062 0.6276 0.5947 0.6370 0.5780 0.5766 0.5603 0.7205 
    11     12     13     14     15     16     17     18     19     20 
0.5688 0.8000 0.5003 0.4927 0.5902 0.6885 0.4373 0.5449 0.6145 0.4919 
    21     22     23     24     25     26     27     28     29     30 
0.6941 0.6437 0.6948 0.5509 0.5332 0.5810 0.5859 0.5600 0.5553 0.3406 
    31     32     33     34     35     36     37     38     39     40 
0.4753 0.5471 0.4471 0.6016 0.4257 0.6114 0.6099 0.6090 0.4858 0.6660 
    41     42     43     44     45     46     47     48     49     50 
0.6276 0.7471 0.6769 0.6073 0.6054 0.3855 0.5127 0.5711 0.5715 0.4743 
    51     52     53     54     55     56     57     58     59     60 
0.7214 0.6914 0.7292 0.5827 0.6231 0.5443 0.5538 0.5494 0.6194 0.5297 
    61     62     63     64     65     66     67     68     69     70 
0.5740 0.6950 0.6886 0.7559 0.5927 0.5149 0.7540 0.7618 0.5176 0.5111 
    71     72     73     74     75     76     77     78     79     80 
0.4881 0.5783 0.4664 0.6391 0.6317 0.5238 0.4294 0.6124 0.6198 0.7153 
    81     82     83     84     85     86     87     88     89     90 
0.5632 0.4658 0.5879 0.5948 0.7144 0.6694 0.6840 0.7221 0.6812 0.7251 
    91     92     93     94     95     96     97     98     99    100 
0.6484 0.6019 0.7035 0.6902 0.6474 0.6905 0.5177 0.5718 0.5718 0.6146 
   101    102    103    104    105    106    107    108    109    110 
0.6073 0.5469 0.5271 0.5634 0.4383 0.6862 0.7013 0.6457 0.6504 0.5383 
   111    112    113    114    115    116    117    118    119    120 
0.5745 0.6685 0.5519 0.5436 0.7995 0.6495 0.6134 0.5589 0.5488 0.5480 
   121    122    123    124    125    126    127    128    129    130 
0.7037 0.6330 0.5566 0.6639 0.8389 0.7593 0.7709 0.7888 0.7012 0.7518 
   131    132    133    134    135    136    137    138    139    140 
0.7565 0.7607 0.6962 0.7191 0.6607     NA 0.5913 0.6505 0.7207 0.7004 
   141    142    143    144    145    146    147    148    149    150 
0.7146 0.4990 0.4330 0.4912 0.4425 0.4874 0.4386 0.5240 0.4946 0.4221 
   151    152    153    154    155    156    157    158    159    160 
0.4871 0.5822 0.6155 0.5247 0.3934 0.6733 0.5668 0.7574 0.5878 0.7119 
   161    162    163    164    165    166    167    168    169    170 
0.5698 0.2181 0.5959 0.6793 0.5889 0.7919 0.7429 0.8057 0.7928 0.7594 
   171    172 
0.4911 0.5345 
> 
> # test against 2012 resilience scores
> ohi.load('results_global_data', dir='/usr/local/ohi/src/model/global2012/doc/')
> x.actual <- subset(results_global_data, goal.subgoal=='HAB')[,'resilience']
> names(x.actual) <- subset(results_global_data, goal.subgoal=='HAB')[,'id']
> x.actual <- x.actual[names(x)]
> stopifnot(names(x) == names(x.actual))
> stopifnot(all(round(x.actual/100 - x, 3) == 0.000, na.rm=T))
> 
> 
> proc.time()
   user  system elapsed 
  0.824   0.052   0.872 
